---
import Layout from "../layouts/Layout.astro";

import applyNow from "../images/applyNow.png";
import ps from "../images/ps.png";
import submitArrow from "../images/submitArrow.png";
import { Image } from "astro:assets";
//import { Image, Picture } from "@astrojs/image/components";

const props = Astro.props;

console.log(props.jobProfile);
---

{
  Object.keys(props).length && (
    <Layout title="hiring-app" seoTitle="hiring-app" description={null}>
      <section>
        <div class="gradient">
          <div class="bgImage">
            <div class="title">
              <>
                <span set:html={props.jobProfile} />
                <br />
              </>
              <a href="#apply">
                <Image
                  class="btn optimization "
                  style="width: 32%; margin-bottom: 5%;"
                  src={applyNow}
                  alt=""
                />
              </a>
            </div>
          </div>
        </div>
      </section>

      <section class="margins" id="apply">
        <p class="heading">About the job</p>
        <span class="text" set:html={props.aboutJob} />

        <p class="heading">Responsibilities</p>
        <span class="text" set:html={props.responsibilities} />

        <p class="heading">job requirements</p>
        <span
          class="text"
          style="margin-bottom: 2%;"
          set:html={props.jobRequirements}
        />
        {props.qualifications && (
          <>
            <p class="heading">Qualifications</p>
            <span
              class="text"
              style="margin-bottom: 2%;"
              set:html={props.qualifications}
            />
          </>
        )}

        <br />
      </section>

      <section class="formSec">
        <div class="row">
          <div class="col-5">
            <p class="formTitle">Interested?</p>
            <p class="formTitle" style="color:#e5ff53;">
              Apply Now!
            </p>
          </div>

          <div class="col-7">
            <form action="" id="application">
              <div class="input-group mb-3 input-group-lg">
                <div class="input-group-prepend" style="margin-bottom: 2.5%;">
                  <span class="inp-title input-group-text">Your Name :</span>
                </div>
                <input
                  type="text"
                  style="margin-bottom: 2.5%;"
                  class="input form-control"
                  id="name"
                  name="name"
                  required
                />
              </div>

              <div
                style="margin-bottom: 3%;"
                class="input-group mb-3 input-group-lg"
              >
                <div class="input-group-prepend" style="margin-bottom: 2.5%;">
                  <span class="inp-title input-group-text">Your Email :</span>
                </div>
                <input
                  type="email"
                  style="margin-bottom: 2.5%;"
                  class="input form-control"
                  id="email"
                  name="email"
                  required
                />
              </div>

              <div
                style="margin-bottom: 3%;"
                class="input-group mb-3 input-group-lg"
              >
                <div class="input-group-prepend" style="margin-bottom: 2.5%;">
                  <span class="inp-title input-group-text">Phone :</span>
                </div>
                <input
                  type="tel"
                  style="margin-bottom: 2.5%;"
                  class="input form-control"
                  id="phoneNumber"
                  name="phoneNumber"
                  pattern="[0-9]{10}"
                  required
                />
              </div>

              <div
                style="margin-bottom: 3%;"
                class="input-group mb-3 input-group-lg"
              >
                <div class="input-group-prepend" style="margin-bottom: 2.5%;">
                  <span class="inp-title input-group-text">
                    Upload resume :
                  </span>
                </div>
                <input
                  type="file"
                  style="margin-bottom: 2.5%; padding-top: 4.5%;"
                  class="input form-control"
                  id="resume"
                  name="resume"
                  required
                />
              </div>

              <div
                style="margin-bottom: 3%;"
                class="input-group mb-3 input-group-lg"
              >
                <div class="input-group-prepend" style="margin-bottom: 2.5%;">
                  <span class="inp-title input-group-text">
                    Portfolio Link :
                  </span>
                </div>
                <input
                  type="text"
                  style="margin-bottom: 2.5%;"
                  class="input form-control"
                  id="portfolioLink"
                  name="portfolioLink"
                  required
                />
              </div>

              <div
                style="margin-bottom: 3%;"
                class="input-group mb-3 input-group-lg"
              >
                <div class="input-group-prepend" style="margin-bottom: 2.5%;">
                  <span class="inp-title input-group-text">
                    Linkedin (optional) :
                  </span>
                </div>
                <input
                  type="text"
                  style="margin-bottom: 2.5%;"
                  class="input form-control"
                  id="linkedinUsername"
                  name="linkedinUsername"
                />
              </div>

              <div
                style="margin-bottom: 3%;"
                class="input-group mb-3 input-group-lg"
              >
                <div class="input-group-prepend" style="margin-bottom: 2.5%;">
                  <span class="inp-title input-group-text">
                    Current Job Role :
                  </span>
                </div>
                <input
                  type="text"
                  style="margin-bottom: 2.5%;"
                  class="input form-control"
                  id="currentJobRole"
                  name="currentJobRole"
                  required
                />
              </div>

              <div
                style="margin-bottom: 3%;"
                class="input-group mb-3 input-group-lg"
              >
                <div class="input-group-prepend" style="margin-bottom: 2.5%;">
                  <span class="inp-title input-group-text">
                    Year of Experience :
                  </span>
                </div>
                <input
                  type="text"
                  style="margin-bottom: 2.5%;"
                  class="input form-control"
                  id="experience"
                  name="experience"
                  required
                />
              </div>

              <div
                style="margin-bottom: 3%;"
                class="input-group mb-3 input-group-lg"
              >
                <div class="input-group-prepend" style="margin-bottom: 2.5%;">
                  <span class="inp-title input-group-text">
                    Notice Period :
                  </span>
                </div>
                <input
                  type="text"
                  style="margin-bottom: 2.5%;"
                  class="input form-control"
                  id="noticePeriod"
                  name="noticePeriod"
                  required
                />
              </div>

              <div
                style="margin-bottom: 3%;"
                class="input-group mb-3 input-group-lg"
              >
                <div class="input-group-prepend" style="margin-bottom: 2.5%;">
                  <span class="inp-title input-group-text">Expected CTC :</span>
                </div>
                <input
                  type="text"
                  style="margin-bottom: 2.5%;"
                  class="input form-control"
                  id="expectedCTC"
                  name="expectedCTC"
                  required
                />
              </div>

              <button
                class="submitBtn btn"
                type="submit"
                id="submit"
                aria-label="submit"
              >
                <Image src={submitArrow} class=" optimization" alt="" /> submit
                application
              </button>
            </form>
          </div>
        </div>
      </section>
    </Layout>
  )
}
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
  import Swal from "sweetalert2";

  document
    .getElementById("application")
    .addEventListener("submit", function (event) {
      event.preventDefault();

      var formData = new FormData(event.target as HTMLFormElement);

      var name = formData.get("name");
      var email = formData.get("email");
      var phoneNumber = formData.get("phoneNumber");
      var resume = formData.get("resume");
      var portfolioLink = formData.get("portfolioLink");
      var linkedinUsername = formData.get("linkedinUsername");
      var currentJobRole = formData.get("currentJobRole");
      var experience = formData.get("experience");
      var noticePeriod = formData.get("noticePeriod");
      var expectedCTC = formData.get("expectedCTC");

      const careerFormData = `
    <style>
    #customers {
        font-family: Arial, Helvetica, sans-serif;
        border-collapse: collapse;
        width: 100%;
    }

    #customers td,
    #customers th {
        border: 1px solid #ddd;
        padding: 8px;
    }

    #customers tr:nth-child(even) {
        background-color: #f2f2f2;
    }

    #customers tr:hover {
        background-color: #ddd;
    }

    #customers th {
        padding-top: 12px;
        padding-bottom: 12px;
        text-align: left;
        background-color: #04AA6D;
        color: white;
    }
</style>

<body>
    <table id="customers">
      <tr>
            <td style="font-weight:bold;">For Job Profile</td>
            <td set:html={props.jobProfile}></td>
        </tr>

        <tr>
            <td style="font-weight:bold;">Name</td>
            <td>${name}</td>
        </tr>
        <tr>
          <td style="font-weight:bold;">Email</td>
          <td >${email}</td>
        </tr>
        <tr>
      <td style="font-weight:bold;">Phone</td>
      <td >${phoneNumber}</td>
      </tr>

      <tr>
      <td style="font-weight:bold;">Phone</td>
      <td >${portfolioLink}</td>
    </tr>

    <tr>
    <td style="font-weight:bold;">Education</td>
    <td ><a href='${linkedinUsername}'></a></td>
  </tr>

        <tr>
        <td style="font-weight:bold;">Designation</td>
        <td > ${currentJobRole}</td>
      </tr>
     
    <tr>
    <td style="font-weight:bold;">Experience</td>
    <td >${experience}</td>
  </tr>
    <tr>
    <td style="font-weight:bold;">Education</td>
    <td ><a href='${noticePeriod}'></a></td>
  </tr>

  <tr>
    <td style="font-weight:bold;">Education</td>
    <td ><a href='${expectedCTC}'></a></td>
  </tr>

 
    </table>
</body>
    `;

      // console.log(fileRef.current.files[0]);
      const formData2 = new FormData();
      formData2.append("type", "career");
      formData2.append("body", careerFormData);
      formData2.append("file", resume);

      fetch("https://iiclab-backend.vtour.tech/mail", {
        method: "POST",
        body: formData2,
        redirect: "follow",
      })
        .then(function (response) {
          if (response.ok) {
            return response.text();
          }
          throw new Error("ERROR:" + response.status);
        })
        .then(function (data) {
          // swal({
          //   title: "Thank Youpppp!",
          //   icon: "success",
          // });

          Swal.fire({
            title: "Thank you for applying",
            icon: "success",
            text: `Your application has been successfully submitted. The team will review it and get back to you soon!`,

            confirmButtonText: "CLOSE",
            customClass: {
              confirmButton: "sweet-close-btn",
              icon: "sweet-icon",
              popup: "sweet-container",
              title: "sweet-title",
            },
          });
        })
        .catch(function (error) {
          console.error("error:", error);
        });
      (event.target as HTMLFormElement).reset();
    });
</script>

<style>
  .optimization {
    height: auto;
  }
  .mb-3 {
    margin-bottom: 1.6% !important;
  }
  input::file-selector-button {
    color: white !important;
    padding: 0.5em;
    border: 0 !important;
    border-radius: 3px;
    background-color: #1a1a1a !important;
  }

  .input:focus,
  .textArea:focus,
  button {
    outline: none !important;
    box-shadow: none !important;
  }
  ul.a {
    list-style-type: disc;
    line-height: 2.1 !important;
  }
  .title {
    color: white;
    font-family: "Deutschlander";
    text-transform: uppercase;
    font-size: 13vw;
    font-weight: 400;
    font-style: normal;
    line-height: 0.85;

    width: 65%;
    margin-top: 9%;
  }

  .bgImage {
    background-image: url(../images/hiringBG2.png);
    background-size: cover;

    object-fit: cover;
    padding-left: 10%;
    padding-top: 10%;
  }

  .gradient {
    background-image: linear-gradient(black 100%, #1a1a1a 0%);
  }

  .margins {
    margin: 5% 8% 4% 8%;
  }

  .heading {
    font-family: "Deutschlander";
    text-transform: uppercase;
    font-size: 6.5vw;
    font-weight: 400;
    font-style: normal;
    line-height: 0.85;
  }
  .text {
    width: 70%;
    font-family: "anek devanagari";
    opacity: 70%;
    font-weight: 500;
    font-size: 1.3vw;
    display: inline-block;
    line-height: 2;
    margin-bottom: 4%;
  }
  .formSec {
    background-color: #1a1a1a;
    padding-top: 7%;
    padding-left: 8%;
    padding-right: 8%;
  }
  .inputCss {
    background-color: #1a1a1a;
    height: 3vw;
    border-radius: 0 10px 0 10px;
    border-left: 0 !important;
    color: rgba(255, 255, 255, 1);
    font-size: calc(7px + 0.390625vw);
  }

  .formTitle {
    color: white;
    font-family: "Deutschlander";
    text-transform: uppercase;
    font-size: 11.5vw;
    font-weight: 400;
    font-style: normal;
    line-height: 0.85;
  }

  /* form css */
  .form-control {
    border-left: 0 !important;
  }
  .inp-title,
  .input {
    background-color: #1a1a1a;
  }
  .input-group-text {
    padding: 2.3vw 2.8vw;
    color: white;
    font-family: "anek devanagari";
    text-transform: uppercase;
    font-size: 1.2vw;
    /* border-right: 0 !important; */
    border-radius: 0 0 0 0.7vw !important;
    border: 1.3px solid #575859 !important;
  }
  .form-control {
    color: #e5ff53 !important;
    font-weight: 500;
    font-family: "anek devanagari";
    font-size: 1.35vw !important;
    background-color: #1a1a1a !important;
    border-radius: 0 0.7vw 0 0 !important;
    border-top: 1.3px solid #575859 !important;
    border-right: 1.3px solid #575859 !important;
    border-bottom: 1.3px solid #575859 !important;
  }

  .textArea {
    background-color: #1a1a1a;
    width: 100%;
    color: white;
    font-size: 1.2vw;
    font-family: anek devanagari;
    padding-top: 4%;
    text-transform: uppercase;
    border-radius: 0 0.7vw 0.7vw 0.7vw !important;
  }
  .submitBtn {
    width: 100%;
    background-color: #e5ff53;
    text-align: center;
    padding: 3%;
    font-family: "anek devanagari";
    text-transform: uppercase;
    font-weight: 600;
    font-size: 1.2vw;
    border-radius: 0 0 0.7vw 0.7vw;
  }
  input::placeholder {
    /* Chrome, Firefox, Opera, Safari 10.1+ */
    color: #e5ff53 !important;
    opacity: 1; /* Firefox */
  }

  input:-ms-input-placeholder {
    /* Internet Explorer 10-11 */
    color: #e5ff53 !important;
  }

  input::-ms-input-placeholder {
    /* Microsoft Edge */
    color: #e5ff53 !important;
  }
</style>
<style is:global>
  .swal2-html-container {
    font-family: "Anek Devanagari" !important;
    font-size: 1.2vw !important;
    font-weight: 500 !important;
    line-height: 1 !important;
    letter-spacing: 0em !important;
    opacity: 50%;
  }
  .swal2-success-line-tip,
  .swal2-success-line-long {
    background: #1a1a1a !important;
  }

  .sweet-container {
    border: 2px solid #1a1a1a !important;
  }
  .swal2-success-ring {
    border: 6.64px solid #f7fecb !important;
  }

  .sweet-title {
    font-family: Deutschlander !important;
    font-size: 5vw !important;
    font-weight: 400 !important;
    line-height: 1 !important;
    letter-spacing: 0px !important;
    text-transform: uppercase !important;
    color: #1a1a1a !important;
  }

  .swal2-actions {
    width: 100% !important;
  }
  .sweet-close-btn {
    color: #e5ff53 !important;
    background: #1a1a1a !important;
    width: 34vw !important;
    font-family: Deutschlander !important;
    font-size: 3.5vw !important;
    font-weight: 400 !important;
    line-height: 1 !important;
    letter-spacing: 0px !important;
    padding-top: 2% !important;
    padding-bottom: 2% !important;
    border-radius: 0px 0px 8px 8px !important;
    margin-bottom: 0vw;
  }
</style>
